student(reg_no,fname,lname,sem)
sem(sem,tot_cred)
course(course_id,course_name,sem,credits)
series_marks(sem,reg_no,course_id,marks)

------------------------------------------------------------------------------------------------------------------------------------------------------------------------
create table student(reg_no varchar(10) not null primary key,fname varchar(15) not null);
insert into student(reg_no,fname)
values(1,'nidhi'),
(2,'muhs'),
(3,'adish'),
(4,'bala'),
(5,'vg'),
(6,'varsha'),
(7,'reppan');

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
create table sem(sem varchar(5) primary key not null,tot_cred int not null);
insert into sem(sem,tot_cred) 
values ('S1',24),
('S2',23),
('S3',24),
('S4',23),
('S5',23),
('S6',23),
('S7',22),
('S8',18);

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
create table course(course_id varchar(20) primary key not null,course_name varchar(50) not null,sem varchar(5) references sem(sem),credits int not null);
insert into course(course_id,course_name,sem,credits) 
values 
('MA101','calculus','S1',4),
('PH100','Engineering Physics','S1',4),
('BE102','design','S2',3),
('EE100','electrical','S2',3),
('BE110','Engineering graphics','S1',3),
('BE105','icps','S1',3),
('BE103','Introduction to Sustainable Engineering','S1',3),
('EC100','Basics of Electronics','S1',3),
('MA102','differential equations','S2',4),
('CY100','Engineering chemistry','S2',4),
('BE100','Engineering Mechanics','S2',4),
('CS100','Basics of computer programming','S2',3),
('MA201','laca','S3',4),
('CS201','DCS','S3',4),
('IT201','DSD','S3',4),
('CS205','DS','S3',4),
('IT203','DC','S3',3),
('HS210','Life skills','S3',3),
('MA202','Probability','S4',4),
('CS202','COA','S4',4),
('IT202','AAD','S4',4),
('IT204','OOT','S4',3),
('CS208','PDBD','S4',3),
('HS200','economics','S4',3),
('IT301','SADP','S5',4),
('IT303','TOC','S5',4),
('CS305','MPC','S5',3),
('IT305','OS','S5',3),
('IT307','CN','S5',3),
('IT360','ELECTIVE','S5',3);

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
CREATE TABLE series_marks(reg_no varchar(5) references student(reg_no),course_id varchar(20) references course(course_id),marks int not null);
insert into series_marks(reg_no,course_id,marks)
values
(1,'MA101',44),
(2,'MA101',45),
(3,'MA101',43),
(4,'MA101',44),
(5,'MA101',46),
(6,'MA101',41),
(7,'MA101',47),
(1,'MA201',46),
(2,'MA201',45),
(3,'MA201',45),
(4,'MA201',44),
(5,'MA201',47),
(6,'MA201',45),
(7,'MA201',47),
(1,'MA202',46),
(2,'MA202',44),
(3,'MA202',45),
(4,'MA202',44),
(5,'MA202',43),
(6,'MA202',45),
(7,'MA202',42),
(1,'CS202',46),
(2,'CS202',44),
(3,'CS202',45),
(4,'CS202',44),
(5,'CS202',43),
(6,'CS202',45),
(7,'CS202',42),
(1,'CS201',43),
(2,'CS201',44),
(3,'CS201',45),
(4,'CS201',47),
(5,'CS201',43),
(6,'CS201',45),
(7,'CS201',43),
(1,'HS210',47),
(2,'HS210',45),
(3,'HS210',45),
(4,'HS210',45),
(5,'HS210',43),
(6,'HS210',46),
(7,'HS210',43),
(1,'HS200',47),
(2,'HS200',45),
(3,'HS200',45),
(4,'HS200',45),
(5,'HS200',43),
(6,'HS200',46),
(7,'HS200',43),
(1,'IT201',42),
(2,'IT201',46),
(3,'IT201',41),
(4,'IT201',41),
(5,'IT201',40),
(6,'IT201',40),
(7,'IT201',45),
(1,'IT203',42),
(2,'IT203',46),
(3,'IT203',50),
(4,'IT203',41),
(5,'IT203',47),
(6,'IT203',40),
(7,'IT203',45),
(1,'IT202',42),
(2,'IT202',46),
(3,'IT202',50),
(4,'IT202',41),
(5,'IT202',47),
(6,'IT202',40),
(7,'IT204',45),
(1,'IT204',42),
(2,'IT204',46),
(3,'IT204',50),
(4,'IT204',41),
(5,'IT204',47),
(6,'IT204',40),
(7,'IT204',45),
(1,'PH100',43),
(2,'PH100',45),
(3,'PH100',46),
(4,'PH100',43),
(5,'PH100',44),
(6,'PH100',47),
(7,'PH100',43),
(1,'BE102',46),
(2,'BE102',43),
(3,'BE102',42),
(4,'BE102',45),
(5,'BE102',48),
(6,'BE102',44),
(7,'BE102',45),
(1,'EE100',44),
(2,'EE100',45),
(3,'EE100',44),
(4,'EE100',44),
(5,'EE100',45),
(6,'EE100',43),
(7,'EE100',46),
(1,'BE110',46),
(2,'BE110',43),
(3,'BE110',42),
(4,'BE110',40),
(5,'BE110',48),
(6,'BE110',49),
(7,'BE110',47),
(1,'BE105',48),
(2,'BE105',41),
(3,'BE105',42),
(4,'BE105',45),
(5,'BE105',43),
(6,'BE105',44),
(7,'BE105',47),
(1,'BE103',47),
(2,'BE103',48),
(3,'BE103',49),
(4,'BE103',46),
(5,'BE103',43),
(6,'BE103',44),
(7,'BE103',45),
(1,'EC100',41),
(2,'EC100',45),
(3,'EC100',44),
(4,'EC100',44),
(5,'EC100',45),
(6,'EC100',47),
(7,'EC100',46),
(1,'MA102',44),
(2,'MA102',48),
(3,'MA102',43),
(4,'MA102',44),
(5,'MA102',46),
(6,'MA102',45),
(7,'MA102',47),
(1,'CY100',48),
(2,'CY100',45),
(3,'CY100',46),
(4,'CY100',44),
(5,'CY100',45),
(6,'CY100',44),
(7,'CY100',46),
(1,'BE100',48),
(2,'BE100',41),
(3,'BE100',42),
(4,'BE100',45),
(5,'BE100',43),
(6,'BE100',44),
(7,'BE100',47),
(1,'CS100',48),
(2,'CS100',45),
(3,'CS100',44),
(4,'CS100',45),
(5,'CS100',43),
(6,'CS100',44),
(7,'CS100',45),
(1,'CS205',48),
(2,'CS205',47),
(3,'CS205',49),
(4,'CS205',47),
(5,'CS205',47),
(6,'CS205',46),
(7,'CS205',47),
(1,'CS208',48),
(2,'CS208',47),
(3,'CS208',49),
(4,'CS208',47),
(5,'CS208',47),
(6,'CS208',46),
(7,'CS208',47),
(1,'IT301',42),
(2,'IT301',46),
(3,'IT301',41),
(4,'IT301',41),
(5,'IT301',40),
(6,'IT301',40),
(7,'IT301',45),
(1,'IT303',42),
(2,'IT303',42),
(3,'IT303',41),
(4,'IT303',45),
(5,'IT303',40),
(6,'IT303',40),
(7,'IT303',43),
(1,'IT305',42),
(2,'IT305',46),
(3,'IT305',41),
(4,'IT305',41),
(5,'IT305',40),
(6,'IT305',40),
(7,'IT305',45),
(1,'IT307',42),
(2,'IT307',46),
(3,'IT307',45),
(4,'IT307',49),
(5,'IT307',47),
(6,'IT307',48),
(7,'IT307',45),
(1,'CS305',48),
(2,'CS305',47),
(3,'CS305',49),
(4,'CS305',47),
(5,'CS305',47),
(6,'CS305',46),
(7,'CS305',47),
(1,'IT360',42),
(2,'IT360',42),
(3,'IT360',41),
(4,'IT360',45),
(5,'IT360',40),
(6,'IT360',40),
(7,'IT360',43);


-----------------------------------------------------------------------------------------------------------------------------------------------------------------------

select distinct(reg_no),sum(marks) from (select s.reg_no,s.fname,c.course_id,d.marks from student s,course c,series_marks d,sem e where s.reg_no=d.reg_no and c.course_id=d.course_id and e.sem=c.sem and c.sem='S1') as foo;
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
select reg_no,fname,total,dense_RANK() over (order by total desc) as class_rank from (select distinct(foo.reg_no),foo.fname,sum(marks) as total from (select s.reg_no,s.fname,c.course_id,d.marks from student s,course c,series_marks d,sem e where s.reg_no=d.reg_no and c.course_id=d.course_id and e.sem=c.sem and c.sem='S5') as foo group by foo.reg_no,foo.fname order by reg_no asc) as list order by 1;



